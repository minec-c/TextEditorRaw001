<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Emscripten-Generated Code</title>
    <style>
      .emscripten { padding-right: 0; margin-left: auto; margin-right: auto; display: block; }
      textarea.emscripten { font-family: monospace; width: 80%; }
      div.emscripten { text-align: center; }
      div.emscripten_border { border: 1px solid black; }
      /* the canvas *must not* have any border or padding, or mouse coords will be wrong */
      canvas.emscripten { border: 0px none; background-color: black; }



    </style>
  </head>
  <body>
    <hr/>
    <div class="emscripten">
    </div>
    <div class="emscripten_border">
      <canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()" tabindex=-1></canvas>

    <input id="textInput"
      type="text"
      autocomplete="off"
      autocorrect="off"
      spellcheck="false"
      style="width:90%; font-size:18px;"
      placeholder="Type here (Android)">
    </div>
    <hr/>
    <div class="emscripten">
    </div>
    
    <hr/>
    <textarea class="emscripten" id="output" rows="8"></textarea>
    <hr>
<script>
const input = document.getElementById("textInput");
const output = document.getElementById("output");

window.addEventListener("load", () => input.focus());
document.getElementById("canvas").addEventListener("mousedown", () => input.focus());

var Module = {
  print: function(text) {
    if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
    console.log(text);
    output.value += text + "\n";
    output.scrollTop = output.scrollHeight;
  },
  printErr: function(text) {
    if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
    console.error(text);
    output.value += "[ERR] " + text + "\n";
    output.scrollTop = output.scrollHeight;
  }
};

let lastValue = "";
input.addEventListener("input", () => {
  const cur = input.value;

  if (cur.length > lastValue.length) {
    const added = cur.slice(lastValue.length);
    Module.ccall("on_text_input", null, ["string"], [added]);
  } else if (cur.length < lastValue.length) {
    const diff = lastValue.length - cur.length;
    for (let i = 0; i < diff; i++) {
      Module.ccall("on_backspace", null, [], []);
    }
  }
  lastValue = cur;
});

window.onerror = function(msg, url, line, col) {
  output.value += `[ERR] ${msg}@${line}:${col}\n`;
  output.scrollTop = output.scrollHeight;
};
</script>
    <script async type="text/javascript" src="testwb17.js"></script>
  </body>
</html>



