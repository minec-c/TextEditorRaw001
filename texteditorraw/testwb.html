<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <title>TextEditorRaw</title>

  <style>
    .texteditorraw { margin: auto; display: block; }
    textarea.texteditorraw {
      font-family: monospace;
      width: 95%;
      font-size: 12px;
    }
    canvas.texteditorraw {
      border: 0;
      background-color: black;
    }
  </style>
</head>

<body>

<hr>

<!-- DEBUG CONSOLE -->
<textarea class="texteditorraw" id="output" rows="14"></textarea>

<hr>

<div id="status" class="texteditorraw">Downloading...</div>

<div class="texteditorraw_border">
  <canvas class="texteditorraw" id="canvas"
    oncontextmenu="event.preventDefault()" tabindex="-1"></canvas>
</div>

<!-- âœ… HIDDEN INPUT (MUST BE IN BODY) -->
<input
  id="sdl-input"
  type="text"
  autocomplete="off"
  autocorrect="off"
  autocapitalize="off"
  spellcheck="false"
  style="
    position:absolute;
    opacity:0;
    left:-1000px;
    top:-1000px;
  "
>

<hr>

<script type="text/javascript">
(function () {
  var input = document.getElementById("sdl-input");
  var canvas = document.getElementById("canvas");

  if (!input || !canvas) {
    console.error("SDL input or canvas not found");
    return;
  }

  function focusInput() {
    input.focus();
  }

  canvas.addEventListener("touchstart", focusInput);
  canvas.addEventListener("mousedown", focusInput);

  function pageLog(prefix, text) {
    var el = document.getElementById("output");
    if (!el) return;
    el.value += prefix + text + "\n";
    el.scrollTop = el.scrollHeight;
  }

  window.Module = {
    preRun: [],
    postRun: [],
    print: function (text) {
      pageLog("[OUT] ", text);
    },
    printErr: function (text) {
      pageLog("[ERR] ", text);
    },
    canvas: canvas,
    setStatus: function (text) {
      document.getElementById("status").innerHTML = text;
      pageLog("[STATUS] ", text);
    }
  };

  window.onerror = function (msg, url, line, col) {
    Module.printErr(msg + " @ " + line + ":" + col);
    return true;
  };

})();
</script>

<script async src="testwb9.js"></script>

</body>
</html>
