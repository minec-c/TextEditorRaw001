<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <title>TextEditorRaw</title>

  <style>
    .texteditorraw { margin: auto; display: block; }
    textarea.texteditorraw {
      font-family: monospace;
      width: 95%;
      font-size: 12px;
    }
    canvas.texteditorraw {
      border: 0;
      background-color: black;
    }
  </style>
</head>

<body>

<hr>

<!-- DEBUG CONSOLE -->
<textarea class="texteditorraw" id="output" rows="14"></textarea>

<hr>

<div id="status" class="texteditorraw">Downloading...</div>

<div class="texteditorraw_border">
  <canvas class="texteditorraw" id="canvas"
    oncontextmenu="event.preventDefault()" tabindex="-1"></canvas>
</div>

<hr>

<script type="text/javascript">
  function pageLog(prefix, text) {
    var el = document.getElementById("output");
    if (!el) return;
    el.value += prefix + text + "\n";
    el.scrollTop = el.scrollHeight;
  }

  var Module = {
    preRun: [],
    postRun: [],

    print: function (text) {
      if (arguments.length > 1)
        text = Array.prototype.slice.call(arguments).join(" ");
      pageLog("[OUT] ", text);
    },

    printErr: function (text) {
      if (arguments.length > 1)
        text = Array.prototype.slice.call(arguments).join(" ");
      pageLog("[ERR] ", text);
    },

    canvas: (function () {
      var canvas = document.getElementById("canvas");
      return canvas;
    })(),

    setStatus: function (text) {
      document.getElementById("status").innerHTML = text;
      pageLog("[STATUS] ", text);
    }
  };

  window.onerror = function (msg, url, line, col) {
    Module.printErr(msg + " @ " + line + ":" + col);
    return true;
  };

  window.addEventListener("unhandledrejection", function (e) {
    Module.printErr("Promise rejection: " + e.reason);
  });
</script>

<script async src="testwb9.js"></script>

</body>

</html>
